<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¦ê±°ìš´ í¬ë¦¬ìŠ¤ë§ˆìŠ¤</title>
    <!-- ì‚°íƒ€ íŒŒë¹„ì½˜ (URL ì¸ì½”ë”©í•´ì„œ ì—ë””í„° ê²½ê³  ë°©ì§€) -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ctext y='50%25' x='50%25' dominant-baseline='middle' text-anchor='middle' font-size='52'%3EğŸ…%3C/text%3E%3C/svg%3E">
    <style>
        body {
            background-color: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* 61ì—´ 26í–‰ì˜ ì™„ë²½í•œ ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ êµ¬ì¶• */
        #screen {
            display: grid;
            grid-template-columns: repeat(61, 10px); /* í•œ ì¹¸ë‹¹ 10px ê³ ì • */
            grid-template-rows: repeat(26, 18px);    /* í•œ ì¤„ë‹¹ 18px ê³ ì • */
            background-color: #000;
            font-weight: bold;
            font-size: 16px;
            user-select: none;
        }

        .char {
            width: 10px;
            height: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* ì™¼ìª½ ìƒë‹¨ ìŠ¤í”¼ì»¤ ë²„íŠ¼ */
        #audio-toggle {
            position: fixed;
            top: 8px;
            left: 8px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            z-index: 1000;
        }

        #audio-toggle.muted {
            opacity: 0.5;
        }
    </style>
</head>
<body>

<button id="audio-toggle" aria-label="ë°°ê²½ ìŒì•… í† ê¸€">ğŸ”Š</button>
<audio id="bgm" src="lhIvW.mp3"></audio>

<div id="screen"></div>

<script>
    // 61ì€ í™€ìˆ˜ì´ë¯€ë¡œ 30ë²ˆ ì¸ë±ìŠ¤ê°€ ì •í™•í•œ ì •ì¤‘ì•™ì´ ë©ë‹ˆë‹¤.
    const width = 61; 
    const height = 26;
    const flakes = ['*', '.', 'â„', 'â€¢'];
    const sky_colors = ['#87afff', '#afd7ff', '#d7ffff'];
    const light_colors = ['#ff0000', '#ffff00', '#00ff00'];
    
    const tree_design = [
        "*",
        "***",
        "*****",
        "*******",
        "*********",
        "***********",
        "*************",
        "|||",
        "|||"
    ];

    let snow = [];
    let ground = new Array(width).fill(1);
    let star_pulse = 0;

    function createFlake() {
        return {
            x: Math.floor(Math.random() * width),
            y: 0,
            char: flakes[Math.floor(Math.random() * flakes.length)],
            speed: Math.random() < 0.66 ? 1 : 2,
            wind: Math.floor(Math.random() * 3) - 1,
            color: sky_colors[Math.floor(Math.random() * sky_colors.length)]
        };
    }

    function updateSnow() {
        if (Math.random() < 0.5) snow.push(createFlake());
        for (let i = snow.length - 1; i >= 0; i--) {
            let f = snow[i];
            f.y += f.speed;
            f.x = (f.x + f.wind + width) % width;
            if (f.y >= height - ground[f.x]) {
                ground[f.x] = Math.min(ground[f.x] + 1, height - 1);
                snow.splice(i, 1);
            }
        }
    }

    function draw() {
        // 1. ë²„í¼ ì´ˆê¸°í™” (ê³µë°±)
        let buffer = Array.from({ length: height }, () => 
            Array(width).fill(' ')
        );
        
        // ìƒ‰ìƒ ì •ë³´ë¥¼ ë‹´ì„ ë³„ë„ì˜ ë²„í¼
        let colorBuffer = Array.from({ length: height }, () => 
            Array(width).fill('')
        );

        // 2. íŠ¸ë¦¬ ê·¸ë¦¬ê¸°
        const tree_start_y = height - tree_design.length - 3;
        
        tree_design.forEach((line, i) => {
            const line_width = line.length;
            const start_x = (width - line_width) / 2; // (61-1)/2 = 30
            
            for (let j = 0; j < line_width; j++) {
                let y = tree_start_y + i;
                let x = start_x + j;
                let char = line[j];

                if (y >= 0 && y < height && x >= 0 && x < width) {
                    if (i === 0 && char === "*") {
                        buffer[y][x] = "â˜…";
                        colorBuffer[y][x] = light_colors[star_pulse % light_colors.length];
                    } else if (char === "*" && Math.random() < 0.15) {
                        buffer[y][x] = "*";
                        colorBuffer[y][x] = light_colors[Math.floor(Math.random() * light_colors.length)];
                    } else if (char === "|") {
                        buffer[y][x] = "|";
                        colorBuffer[y][x] = "#8B4513";
                    } else {
                        buffer[y][x] = char;
                        colorBuffer[y][x] = "#0f8a3c";
                    }
                }
            }
        });

        // 3. ëˆˆ ê·¸ë¦¬ê¸°
        snow.forEach(f => {
            if (f.y >= 0 && f.y < height && f.x >= 0 && f.x < width) {
                buffer[f.y][f.x] = f.char;
                colorBuffer[f.y][f.x] = f.color;
            }
        });

        // 4. ê·¸ë¦¬ë“œ ë°©ì‹ìœ¼ë¡œ ë Œë”ë§ (íƒœê·¸ ê°„ ê³µë°± ë°œìƒ ì›ì²œ ì°¨ë‹¨)
        const screen = document.getElementById('screen');
        let htmlContent = "";
        for (let y = 0; y < height; y++) {
            for (let x = 0; x < width; x++) {
                const char = buffer[y][x];
                const color = colorBuffer[y][x];
                htmlContent += `<div class="char" style="color:${color}">${char}</div>`;
            }
        }
        screen.innerHTML = htmlContent;

        updateSnow();
        star_pulse++;
    }

    setInterval(draw, 100);

    // ì˜¤ë””ì˜¤ ìë™ ì¬ìƒ ë° í† ê¸€ ë²„íŠ¼ ì œì–´ + ì½˜ì†” ì•„ìŠ¤í‚¤ ì•„íŠ¸
    window.addEventListener('DOMContentLoaded', () => {
        const audio = document.getElementById('bgm');
        const btn = document.getElementById('audio-toggle');

        if (audio && btn) {
            // 50ì´ˆë¶€í„° ì‹œì‘
            audio.currentTime = 50;

            // ìë™ ì¬ìƒ ì‹œë„
            const playAudio = () => {
                audio.play().then(() => {
                    btn.classList.remove('muted');
                    btn.textContent = 'ğŸ”Š';
                }).catch(() => {
                    // ìë™ ì¬ìƒì´ ë§‰íŒ ê²½ìš°: ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ ì¬ìƒë¨
                    btn.classList.add('muted');
                    btn.textContent = 'ğŸ”‡';
                });
            };

            playAudio();

            // í† ê¸€ ë²„íŠ¼ ë™ì‘
            btn.addEventListener('click', () => {
                if (audio.paused) {
                    if (audio.currentTime < 50) audio.currentTime = 50;
                    audio.play();
                    btn.classList.remove('muted');
                    btn.textContent = 'ğŸ”Š';
                } else {
                    audio.pause();
                    btn.classList.add('muted');
                    btn.textContent = 'ğŸ”‡';
                }
            });
        }

        const format = [
            "%c             Y     Y",
            "            Y Y   Y Y",
            "              |   |",
            "%c            .-''''-.",
            "           (  o  o  )",
            "           (   ^    )",
            "           (       )",
            "            '-----'",
            "%c           (   â—   )",
            "",
            "%c  M E R R Y   C H R I S T M A S "
        ].join("\n");

        const antlersStyle = [
            "color:#8B4513",
            "font-family: monospace",
            "font-size:12px",
            "font-weight:bold"
        ].join(";");

        const faceStyle = [
            "color:#D2B48C",
            "font-family: monospace",
            "font-size:12px",
            "font-weight:bold"
        ].join(";");

        const noseStyle = [
            "color:#FF0000",
            "font-family: monospace",
            "font-size:12px",
            "font-weight:bold"
        ].join(";");

        const messageStyle = [
            "color:#006400",
            "font-family: monospace",
            "font-size:12px",
            "font-weight:bold"
        ].join(";");

        console.log(format, antlersStyle, faceStyle, noseStyle, messageStyle);
    });
</script>

</body>
</html>